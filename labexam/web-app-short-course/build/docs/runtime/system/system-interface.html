<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>User Directory Application: System Interface</title>
<!-- 2017-04-26 Wed 22:27 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="VLEAD" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="../../style/css/worg-style.css" />
<link rel="stylesheet" type="text/css" href="../../style/css/override.css" />
<link rel="icon" type="image/png" href="../../style/img/favicon/popl.png" />
<script type="text/javascript" src="../../style/js/org-info.js">
/**
 *
 * @source: ../../style/js/org-info.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in ../../style/js/org-info.js.
 *
 * Copyright (C) 2012-2013 Free Software Foundation, Inc.
 *
 *
 * The JavaScript code in this tag is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in ../../style/js/org-info.js.
 *
 */
</script>

<script type="text/javascript">

/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/

<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "1");
org_html_manager.set("LINK_HOME", "../../index.html");
org_html_manager.set("LINK_UP", "../index.html");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="../index.html"> UP </a>
 |
 <a accesskey="H" href="../../index.html"> HOME </a>
</div><div id="content">
<h1 class="title">User Directory Application: System Interface</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Introduction</a></li>
<li><a href="#sec-2">2. The <code>SystemInterface</code> class</a>
<ul>
<li><a href="#sec-2-1">2.1. Constructor</a></li>
<li><a href="#sec-2-2">2.2. Make Session</a>
<ul>
<li><a href="#sec-2-2-1">2.2.1. Test Make Session</a></li>
</ul>
</li>
<li><a href="#sec-2-3">2.3. Make User</a>
<ul>
<li><a href="#sec-2-3-1">2.3.1. Test Make User</a></li>
</ul>
</li>
<li><a href="#sec-2-4">2.4. Make Email</a>
<ul>
<li><a href="#sec-2-4-1">2.4.1. Test Make Email</a></li>
</ul>
</li>
<li><a href="#sec-2-5">2.5. Make Role</a>
<ul>
<li><a href="#sec-2-5-1">2.5.1. Test Make Role</a></li>
</ul>
</li>
<li><a href="#sec-2-6">2.6. Make Name</a>
<ul>
<li><a href="#sec-2-6-1">2.6.1. Test Make Name</a></li>
</ul>
</li>
<li><a href="#sec-2-7">2.7. Get User by email</a>
<ul>
<li><a href="#sec-2-7-1">2.7.1. Test Get User from email</a></li>
</ul>
</li>
<li><a href="#sec-2-8">2.8. Authorize the User</a>
<ul>
<li><a href="#sec-2-8-1">2.8.1. Test AuthorizeUser</a></li>
</ul>
</li>
<li><a href="#sec-2-9">2.9. Logout</a>
<ul>
<li><a href="#sec-2-9-1">2.9.1. Test Logout</a></li>
</ul>
</li>
<li><a href="#sec-2-10">2.10. AddUser</a>
<ul>
<li><a href="#sec-2-10-1">2.10.1. Test Add User</a></li>
</ul>
</li>
<li><a href="#sec-2-11">2.11. DelUser</a>
<ul>
<li><a href="#sec-2-11-1">2.11.1. Test Del User</a></li>
</ul>
</li>
<li><a href="#sec-2-12">2.12. ShowUsers</a>
<ul>
<li><a href="#sec-2-12-1">2.12.1. Test Show Users</a></li>
</ul>
</li>
<li><a href="#sec-2-13">2.13. ShowSessions</a>
<ul>
<li><a href="#sec-2-13-1">2.13.1. Test Show Sessions</a></li>
</ul>
</li>
<li><a href="#sec-2-14">2.14. ShowRoles</a>
<ul>
<li><a href="#sec-2-14-1">2.14.1. Test Show Roles</a></li>
</ul>
</li>
<li><a href="#sec-2-15">2.15. ShowUserDetails</a>
<ul>
<li><a href="#sec-2-15-1">2.15.1. Test Show User Details</a></li>
</ul>
</li>
<li><a href="#sec-2-16">2.16. SetNameoOfUser</a>
<ul>
<li><a href="#sec-2-16-1">2.16.1. Test Set Name of a User</a></li>
</ul>
</li>
<li><a href="#sec-2-17">2.17. SetEmailOfUser</a>
<ul>
<li><a href="#sec-2-17-1">2.17.1. Test Set Email of a User</a></li>
</ul>
</li>
<li><a href="#sec-2-18">2.18. GetRolesOfUser</a>
<ul>
<li><a href="#sec-2-18-1">2.18.1. Test Get Roles of User</a></li>
</ul>
</li>
<li><a href="#sec-2-19">2.19. AddRoleToUser</a>
<ul>
<li><a href="#sec-2-19-1">2.19.1. Test Add Role to User</a></li>
</ul>
</li>
<li><a href="#sec-2-20">2.20. DelRoleOfUser</a>
<ul>
<li><a href="#sec-2-20-1">2.20.1. Test Del Role of User</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
System Interface is the glue between the <code>rest</code> and <code>system</code>.  The world of
<code>rest</code> uses <code>json</code> and the world of <code>system</code> uses objects.  System Interface
allows these two worlds to talk to each other.
</p>
</div>
</div>


<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> The <code>SystemInterface</code> class</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Constructor</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">

<pre class="src src-python" id="class_system_interface"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">SystemInterface</span> ():

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">__init__</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">raise</span> Error(<span style="font-style: italic;">'Can not instantiate'</span>)

    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">initialize</span>(cls):
        System.initialize_system(cls)
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Make Session</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Make a session object that the system can interpret from the email, role and
key that are passed as strings from the REST API Layer.   These three values
are passed as key value pairs.
</p>

<p>
make_session: dictionary -&gt; object
</p>

<div class="org-src-container">

<pre class="src src-python" id="make_session">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">make_session</span>(dictionary):
        <span style="font-weight: bold; font-style: italic;">session_cls</span> = System.delegate.entities[<span style="font-style: italic;">"session"</span>]
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.get_user_by_email(dictionary[<span style="font-style: italic;">'email'</span>])
            <span style="font-weight: bold; font-style: italic;">role</span> = SystemInterface.make_role(dictionary[<span style="font-style: italic;">'role'</span>])
            <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-weight: bold;">str</span>(dictionary[<span style="font-style: italic;">'key'</span>])
            <span style="font-weight: bold; font-style: italic;">session</span> = session_cls(user=user,
                                      role=role,
                                      key=key)
            <span style="font-weight: bold;">return</span> session

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-2-1" class="outline-4">
<h4 id="sec-2-2-1"><span class="section-number-4">2.2.1</span> Test Make Session</h4>
<div class="outline-text-4" id="text-2-2-1">
<div class="org-src-container">

<pre class="src src-python" id="test_make_session"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestMakeSession</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_make_session_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_make_session_passes"</span>

        <span style="font-weight: bold; font-style: italic;">dictionary</span> = {<span style="font-style: italic;">'email'</span>: Config.admin_email,
                          <span style="font-style: italic;">'role'</span>: Config.admin_role,
                          <span style="font-style: italic;">'key'</span>: <span style="font-style: italic;">"abcde"</span> }

        <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(dictionary)
                                                               
        <span style="font-weight: bold;">self</span>.assertEqual(session.get(<span style="font-style: italic;">"role"</span>).get(<span style="font-style: italic;">"val"</span>), Config.admin_role)
        <span style="font-weight: bold;">self</span>.assertEqual(session.get(<span style="font-style: italic;">"user"</span>).get(<span style="font-style: italic;">"name"</span>).get(<span style="font-style: italic;">"val"</span>),
                             Config.admin_name)
        <span style="font-weight: bold;">self</span>.assertEqual(session.get(<span style="font-style: italic;">"user"</span>).get(<span style="font-style: italic;">"email"</span>).get(<span style="font-style: italic;">"val"</span>),
                             Config.admin_email)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Make User</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Make a user object that the system can interpret from name, email and role
that are passed as strings from the upper layer which here is REST API
Layer.  These three values are passed as key value pairs.
</p>

<p>
make-user: dictionary -&gt; object
</p>
<div class="org-src-container">

<pre class="src src-python" id="make_user">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">make_user</span>(dictionary):
        <span style="font-weight: bold; font-style: italic;">user_cls</span> = System.delegate.entities[<span style="font-style: italic;">"user"</span>]

        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">name</span> = SystemInterface.make_name(dictionary[<span style="font-style: italic;">'name'</span>])
            <span style="font-weight: bold; font-style: italic;">email</span> = SystemInterface.make_email(dictionary[<span style="font-style: italic;">'email'</span>])
            <span style="font-weight: bold; font-style: italic;">role</span> = SystemInterface.make_role(dictionary[<span style="font-style: italic;">'role'</span>])

            <span style="font-weight: bold; font-style: italic;">user</span> = user_cls(name=name,
                            email=email,
                            roles=[role])
            <span style="font-weight: bold;">return</span> user

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-3-1" class="outline-4">
<h4 id="sec-2-3-1"><span class="section-number-4">2.3.1</span> Test Make User</h4>
<div class="outline-text-4" id="text-2-3-1">
<div class="org-src-container">

<pre class="src src-python" id="test_make_user"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestMakeUser</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_make_user_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_make_user_passes"</span>

        <span style="font-weight: bold; font-style: italic;">dictionary</span> = {<span style="font-style: italic;">'email'</span>: Config.admin_email,
                          <span style="font-style: italic;">'role'</span>: Config.admin_role,
                          <span style="font-style: italic;">'name'</span>: Config.admin_name
                     }

        <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.make_user(dictionary)
                                                               
        <span style="font-weight: bold;">self</span>.assertEqual(user.get(<span style="font-style: italic;">"roles"</span>)[0].get(<span style="font-style: italic;">"val"</span>), Config.admin_role)
        <span style="font-weight: bold;">self</span>.assertEqual(user.get(<span style="font-style: italic;">"name"</span>).get(<span style="font-style: italic;">"val"</span>), Config.admin_name)
        <span style="font-weight: bold;">self</span>.assertEqual(user.get(<span style="font-style: italic;">"email"</span>).get(<span style="font-style: italic;">"val"</span>), Config.admin_email)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4"><span class="section-number-3">2.4</span> Make Email</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Make an Email object that the system can interpret from email string. 
make-email: string -&gt; object
</p>
<div class="org-src-container">

<pre class="src src-python" id="make_email">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">make_email</span>(email_str):
        <span style="font-weight: bold; font-style: italic;">email_cls</span> = System.delegate.entities[<span style="font-style: italic;">"email"</span>]

        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">email</span> = email_cls(val=email_str)
            <span style="font-weight: bold;">return</span> email
        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-4-1" class="outline-4">
<h4 id="sec-2-4-1"><span class="section-number-4">2.4.1</span> Test Make Email</h4>
<div class="outline-text-4" id="text-2-4-1">
<div class="org-src-container">

<pre class="src src-python" id="test_make_email"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestMakeEmail</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_make_email_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_make_email_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email_str</span> = Config.admin_email

        <span style="font-weight: bold; font-style: italic;">email</span> = SystemInterface.make_email(email_str)
                                                               
        <span style="font-weight: bold;">self</span>.assertEqual(email.get(<span style="font-style: italic;">"val"</span>), Config.admin_email)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5"><span class="section-number-3">2.5</span> Make Role</h3>
<div class="outline-text-3" id="text-2-5">
<p>
Make an Role object that the system can interpret from role string. 
make-role: string -&gt; object
</p>
<div class="org-src-container">

<pre class="src src-python" id="make_role">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">make_role</span>(role_str):
        <span style="font-weight: bold; font-style: italic;">role_cls</span> = System.delegate.entities[<span style="font-style: italic;">"role"</span>]

        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">role</span> = role_cls(val=role_str)
            <span style="font-weight: bold;">return</span> role
        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-5-1" class="outline-4">
<h4 id="sec-2-5-1"><span class="section-number-4">2.5.1</span> Test Make Role</h4>
<div class="outline-text-4" id="text-2-5-1">
<div class="org-src-container">

<pre class="src src-python" id="test_make_role"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestMakeRole</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_make_role_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_make_role_passes"</span>

        <span style="font-weight: bold; font-style: italic;">role_str</span> = Config.admin_role

        <span style="font-weight: bold; font-style: italic;">role</span> = SystemInterface.make_role(role_str)
                                                               
        <span style="font-weight: bold;">self</span>.assertEqual(role.get(<span style="font-style: italic;">"val"</span>), Config.admin_role)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-6" class="outline-3">
<h3 id="sec-2-6"><span class="section-number-3">2.6</span> Make Name</h3>
<div class="outline-text-3" id="text-2-6">
<p>
Make an Name object that the system can interpret from name string. 
make-name: string -&gt; object
</p>
<div class="org-src-container">

<pre class="src src-python" id="make_name">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">make_name</span>(name_str):
        <span style="font-weight: bold; font-style: italic;">name_cls</span> = System.delegate.entities[<span style="font-style: italic;">"name"</span>]

        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">name</span> = name_cls(val=name_str)
            <span style="font-weight: bold;">return</span> name
        
        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-6-1" class="outline-4">
<h4 id="sec-2-6-1"><span class="section-number-4">2.6.1</span> Test Make Name</h4>
<div class="outline-text-4" id="text-2-6-1">
<div class="org-src-container">

<pre class="src src-python" id="test_make_name"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestMakeName</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_make_name_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_make_name_passes"</span>

        <span style="font-weight: bold; font-style: italic;">name_str</span> = Config.admin_name

        <span style="font-weight: bold; font-style: italic;">name</span> = SystemInterface.make_name(name_str)
                                                               
        <span style="font-weight: bold;">self</span>.assertEqual(name.get(<span style="font-style: italic;">"val"</span>), Config.admin_name)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-7" class="outline-3">
<h3 id="sec-2-7"><span class="section-number-3">2.7</span> Get User by email</h3>
<div class="outline-text-3" id="text-2-7">
<p>
Gets user from the system from an email string.
get_user_by_email : email_str -&gt; user object
</p>

<div class="org-src-container">

<pre class="src src-python" id="get_user_by_email">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">get_user_by_email</span>(email_str):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">email</span> = SystemInterface.make_email(email_str)
            <span style="font-weight: bold; font-style: italic;">user</span> = System.do(<span style="font-style: italic;">"get_user_by_email"</span>, email=email)

            <span style="font-weight: bold;">if</span> user <span style="font-weight: bold;">is</span> <span style="font-weight: bold; text-decoration: underline;">None</span>:
                <span style="font-weight: bold;">raise</span> StateError(<span style="font-style: italic;">"User with email = %s is not found"</span>
                                        % email_str)
            <span style="font-weight: bold;">else</span>:
                <span style="font-weight: bold;">return</span> user

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-7-1" class="outline-4">
<h4 id="sec-2-7-1"><span class="section-number-4">2.7.1</span> Test Get User from email</h4>
<div class="outline-text-4" id="text-2-7-1">
<div class="org-src-container">

<pre class="src src-python" id="test_get_user_by_email"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestGetUserByEmail</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_get_user_by_email_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_get_user_by_email_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email_str</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.get_user_by_email(email_str)
                                                               
        <span style="font-weight: bold;">self</span>.assertEqual(user.get(<span style="font-style: italic;">"email"</span>).get(<span style="font-style: italic;">"val"</span>), Config.admin_email)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-8" class="outline-3">
<h3 id="sec-2-8"><span class="section-number-3">2.8</span> Authorize the User</h3>
<div class="outline-text-3" id="text-2-8">
<p>
When a user is authorized, a default role is attached to the session. 
</p>

<div class="org-src-container">

<pre class="src src-python" id="authorize_user">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">authorize_user</span>(email_str, session_key):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.get_user_by_email(email_str)
            <span style="font-weight: bold; font-style: italic;">role</span> = System.do(<span style="font-style: italic;">"login_first_step"</span>, user=user)
            <span style="font-weight: bold; font-style: italic;">session_dict</span> = {<span style="font-style: italic;">'email'</span>: email_str,
                                <span style="font-style: italic;">'role'</span>: <span style="font-weight: bold;">str</span>(role.get(<span style="font-style: italic;">"val"</span>)),
                                <span style="font-style: italic;">'key'</span>: <span style="font-weight: bold;">str</span>(session_key)}

            <span style="font-weight: bold; font-style: italic;">session_obj</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">session</span> = System.do(<span style="font-style: italic;">"login_second_step"</span>, session=session_obj)
            <span style="font-weight: bold;">return</span> <span style="font-weight: bold;">str</span>(role.get(<span style="font-style: italic;">"val"</span>))

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-8-1" class="outline-4">
<h4 id="sec-2-8-1"><span class="section-number-4">2.8.1</span> Test AuthorizeUser</h4>
<div class="outline-text-4" id="text-2-8-1">
<div class="org-src-container">

<pre class="src src-python" id="test_authorize_user"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestAuthorizeUser</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_authorize_user_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_authorize_user_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">session_key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, session_key)
        <span style="font-weight: bold;">self</span>.assertEqual(role_name, Config.admin_role)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-9" class="outline-3">
<h3 id="sec-2-9"><span class="section-number-3">2.9</span> Logout</h3>
<div class="outline-text-3" id="text-2-9">
<div class="org-src-container">

<pre class="src src-python" id="logout">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">logout</span>(session_dict):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold;">return</span> System.do(<span style="font-style: italic;">"logout"</span>, session=session)

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-9-1" class="outline-4">
<h4 id="sec-2-9-1"><span class="section-number-4">2.9.1</span> Test Logout</h4>
<div class="outline-text-4" id="text-2-9-1">
<div class="org-src-container">

<pre class="src src-python" id="test_logout"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestLogout</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_logout_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_logout_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key

        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(System.session_set), 1)

        <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.logout(session_dict)
        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(System.session_set), 0)
</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-sec-2-10" class="outline-3">
<h3 id="sec-2-10"><span class="section-number-3">2.10</span> AddUser</h3>
<div class="outline-text-3" id="text-2-10">
<p>
add_user: session_dict, user_dict -&gt; user
</p>
<div class="org-src-container">

<pre class="src src-python" id="add_user">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">add_user</span>(session_dict, user_dict):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">user_dict</span>[<span style="font-style: italic;">'role'</span>] = <span style="font-style: italic;">"user"</span>
            <span style="font-weight: bold; font-style: italic;">new_user</span> = SystemInterface.make_user(user_dict)
            <span style="font-weight: bold;">return</span> System.do(<span style="font-style: italic;">"add_user"</span>, session=session, user=new_user)
   <span style="font-weight: bold; font-style: italic;">##</span><span style="font-weight: bold; font-style: italic;">TODO:</span>
   <span style="font-weight: bold; font-style: italic;">## </span><span style="font-weight: bold; font-style: italic;">Return json object rather than pure object.</span>
        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-10-1" class="outline-4">
<h4 id="sec-2-10-1"><span class="section-number-4">2.10.1</span> Test Add User</h4>
<div class="outline-text-4" id="text-2-10-1">
<div class="org-src-container">

<pre class="src src-python" id="test_add_user"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestAddUser</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_add_user_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_add_user_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key

        <span style="font-weight: bold; font-style: italic;">user_dict</span> = {<span style="font-style: italic;">'email'</span>: <span style="font-style: italic;">'abc@gnu.org'</span>,
                             <span style="font-style: italic;">'name'</span>: <span style="font-style: italic;">"Test User"</span> }

        <span style="font-weight: bold; font-style: italic;">ret_user</span> = SystemInterface.add_user(session_dict, user_dict)

        <span style="font-weight: bold;">self</span>.assertEqual(ret_user.get(<span style="font-style: italic;">"name"</span>).get(<span style="font-style: italic;">"val"</span>), 
                             user_dict[<span style="font-style: italic;">'name'</span>])
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-11" class="outline-3">
<h3 id="sec-2-11"><span class="section-number-3">2.11</span> DelUser</h3>
<div class="outline-text-3" id="text-2-11">
<p>
del_user: session_dict, email -&gt; user
</p>
<div class="org-src-container">

<pre class="src src-python" id="del_user">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">del_user</span>(session_dict, email_str):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.get_user_by_email(email_str)
            <span style="font-weight: bold;">return</span> System.do(<span style="font-style: italic;">"del_user"</span>, session=session, user=user)

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError,
                    NotFoundError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-11-1" class="outline-4">
<h4 id="sec-2-11-1"><span class="section-number-4">2.11.1</span> Test Del User</h4>
<div class="outline-text-4" id="text-2-11-1">
<div class="org-src-container">

<pre class="src src-python" id="test_del_user"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestDelUser</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_del_user_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_del_user_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key

        <span style="font-weight: bold; font-style: italic;">user_dict</span> = {<span style="font-style: italic;">'email'</span>: <span style="font-style: italic;">'abc@gnu.org'</span>,
                             <span style="font-style: italic;">'role'</span>: Config.user_role,
                             <span style="font-style: italic;">'name'</span>: <span style="font-style: italic;">"Test User"</span> }

        <span style="font-weight: bold; font-style: italic;">ret_user</span> = SystemInterface.add_user(session_dict, user_dict)
        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(SystemInterface.show_users(session_dict)), 2)

        <span style="font-weight: bold; font-style: italic;">ret_user</span> = SystemInterface.del_user(session_dict, <span style="font-style: italic;">"abc@gnu.org"</span>)
        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(SystemInterface.show_users(session_dict)), 1)


    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_del_user_causes_state_error</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_del_user_causes_state_error"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key

        <span style="font-weight: bold;">with</span> <span style="font-weight: bold;">self</span>.assertRaises(StateError):
            SystemInterface.del_user(session_dict, Config.admin_email)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-12" class="outline-3">
<h3 id="sec-2-12"><span class="section-number-3">2.12</span> ShowUsers</h3>
<div class="outline-text-3" id="text-2-12">
<p>
show_users: session_dict -&gt; list of user objects
</p>
<div class="org-src-container">

<pre class="src src-python" id="show_users">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">show_users</span>(session_dict):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">users</span> = System.do(<span style="font-style: italic;">"show_users"</span>, session=session) 
            <span style="font-weight: bold;">return</span> users

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-12-1" class="outline-4">
<h4 id="sec-2-12-1"><span class="section-number-4">2.12.1</span> Test Show Users</h4>
<div class="outline-text-4" id="text-2-12-1">
<div class="org-src-container">

<pre class="src src-python" id="test_show_users"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestShowUsers</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_show_users_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_show_users_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key

        <span style="font-weight: bold; font-style: italic;">user_list</span> = SystemInterface.show_users(session_dict)

        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(user_list), 1)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-13" class="outline-3">
<h3 id="sec-2-13"><span class="section-number-3">2.13</span> ShowSessions</h3>
<div class="outline-text-3" id="text-2-13">
<p>
show_sessions: session_dict -&gt; list of session objects
</p>
<div class="org-src-container">

<pre class="src src-python" id="show_sessions">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">show_sessions</span>(session_dict):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">sessions</span> = System.do(<span style="font-style: italic;">"show_sessions"</span>, session=session) 
            <span style="font-weight: bold;">return</span> sessions

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-13-1" class="outline-4">
<h4 id="sec-2-13-1"><span class="section-number-4">2.13.1</span> Test Show Sessions</h4>
<div class="outline-text-4" id="text-2-13-1">
<div class="org-src-container">

<pre class="src src-python" id="test_show_sessions"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestShowSessions</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_show_sessions_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_show_sessions_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key

        <span style="font-weight: bold; font-style: italic;">session_list</span> = SystemInterface.show_sessions(session_dict)

        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(session_list), 1)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-14" class="outline-3">
<h3 id="sec-2-14"><span class="section-number-3">2.14</span> ShowRoles</h3>
<div class="outline-text-3" id="text-2-14">
<p>
Show all the roles in the system.
show_roles: session_dict -&gt; list of roles objects
</p>
<div class="org-src-container">

<pre class="src src-python" id="show_roles">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">show_roles</span>(session_dict):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">roles</span> = System.do(<span style="font-style: italic;">"get_role_set"</span>, session=session) 
            <span style="font-weight: bold;">return</span> roles

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-14-1" class="outline-4">
<h4 id="sec-2-14-1"><span class="section-number-4">2.14.1</span> Test Show Roles</h4>
<div class="outline-text-4" id="text-2-14-1">
<div class="org-src-container">

<pre class="src src-python" id="test_show_roles"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestShowRoles</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_show_roles_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_show_roles_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key

        <span style="font-weight: bold; font-style: italic;">role_list</span> = SystemInterface.show_roles(session_dict)

        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(role_list), 2)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-15" class="outline-3">
<h3 id="sec-2-15"><span class="section-number-3">2.15</span> ShowUserDetails</h3>
<div class="outline-text-3" id="text-2-15">
<p>
show_user_details: session_dict, email -&gt; user
</p>
<div class="org-src-container">

<pre class="src src-python" id="show_user_details">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">show_user_details</span>(session_dict, email_str):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">email</span> = SystemInterface.make_email(email_str)
            <span style="font-weight: bold;">return</span> System.do(<span style="font-style: italic;">"show_user_details"</span>, session=session, email=email)

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-15-1" class="outline-4">
<h4 id="sec-2-15-1"><span class="section-number-4">2.15.1</span> Test Show User Details</h4>
<div class="outline-text-4" id="text-2-15-1">
<div class="org-src-container">

<pre class="src src-python" id="test_show_user_details"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestShowUserDetails</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_show_user_details_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_show_user_details_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key

        <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.show_user_details(session_dict, 
                                                     Config.admin_email)

        <span style="font-weight: bold;">self</span>.assertEqual(user.get(<span style="font-style: italic;">"email"</span>).get(<span style="font-style: italic;">"val"</span>), Config.admin_email)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-16" class="outline-3">
<h3 id="sec-2-16"><span class="section-number-3">2.16</span> SetNameoOfUser</h3>
<div class="outline-text-3" id="text-2-16">
<p>
set_name_of_user: session_dict, email, name -&gt; user
</p>
<div class="org-src-container">

<pre class="src src-python" id="set_name_of_user">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">set_name_of_user</span>(session_dict, email_str, name_str):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.get_user_by_email(email_str)
            <span style="font-weight: bold; font-style: italic;">name</span> = SystemInterface.make_name(name_str)
            <span style="font-weight: bold;">return</span> System.do(<span style="font-style: italic;">"set_name"</span>,
                                 session=session,
                                 name=name,
                                 user=user)

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-16-1" class="outline-4">
<h4 id="sec-2-16-1"><span class="section-number-4">2.16.1</span> Test Set Name of a User</h4>
<div class="outline-text-4" id="text-2-16-1">
<div class="org-src-container">

<pre class="src src-python" id="test_set_name_of_user"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestSetNameOfUser</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_set_name_of_user_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_set_name_of_user_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key

        <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.set_name_of_user(session_dict, 
                                                    Config.admin_email,
                                                    <span style="font-style: italic;">"Temp Admin"</span>)
                                                    

        <span style="font-weight: bold;">self</span>.assertEqual(user.get(<span style="font-style: italic;">"name"</span>).get(<span style="font-style: italic;">"val"</span>), <span style="font-style: italic;">"Temp Admin"</span>)
</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-sec-2-17" class="outline-3">
<h3 id="sec-2-17"><span class="section-number-3">2.17</span> SetEmailOfUser</h3>
<div class="outline-text-3" id="text-2-17">
<p>
set_email_of_user: session_dict, email, email -&gt; user
</p>
<div class="org-src-container">

<pre class="src src-python" id="set_email_of_user">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">set_email_of_user</span>(session_dict, email_str, set_email_str):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.get_user_by_email(email_str)
            <span style="font-weight: bold; font-style: italic;">email</span> = SystemInterface.make_email(set_email_str)
            <span style="font-weight: bold;">return</span> System.do(<span style="font-style: italic;">"set_email"</span>,
                                 session=session,
                                 email=email,
                                 user=user)

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-17-1" class="outline-4">
<h4 id="sec-2-17-1"><span class="section-number-4">2.17.1</span> Test Set Email of a User</h4>
<div class="outline-text-4" id="text-2-17-1">
<div class="org-src-container">

<pre class="src src-python" id="test_set_email_of_user"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestSetEmailOfUser</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_set_email_of_user_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_set_email_of_user_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key

        <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.set_email_of_user(session_dict, 
                                                    Config.admin_email,
                                                    <span style="font-style: italic;">"tt@gnu.org"</span>)
                                                    

        <span style="font-weight: bold;">self</span>.assertEqual(user.get(<span style="font-style: italic;">"email"</span>).get(<span style="font-style: italic;">"val"</span>), <span style="font-style: italic;">"tt@gnu.org"</span>)
</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-sec-2-18" class="outline-3">
<h3 id="sec-2-18"><span class="section-number-3">2.18</span> GetRolesOfUser</h3>
<div class="outline-text-3" id="text-2-18">
<p>
get_roles_of_user: session_dict, email -&gt; roles
</p>
<div class="org-src-container">

<pre class="src src-python" id="get_roles_of_user">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">get_roles_of_user</span>(session_dict, email_str):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.get_user_by_email(email_str)
            <span style="font-weight: bold;">return</span> System.do(<span style="font-style: italic;">"get_roles_of_user"</span>, session=session, user=user)

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-18-1" class="outline-4">
<h4 id="sec-2-18-1"><span class="section-number-4">2.18.1</span> Test Get Roles of User</h4>
<div class="outline-text-4" id="text-2-18-1">
<div class="org-src-container">

<pre class="src src-python" id="test_get_roles_of_user"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestGetRolesOfUser</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_get_roles_of_user_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_get_roles_of_user_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key

        <span style="font-weight: bold; font-style: italic;">roles</span> = SystemInterface.get_roles_of_user(session_dict, 
                                                  Config.admin_email)

        <span style="font-weight: bold;">self</span>.assertEqual(roles[0].get(<span style="font-style: italic;">"val"</span>), Config.admin_name)
        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(roles), 1)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-19" class="outline-3">
<h3 id="sec-2-19"><span class="section-number-3">2.19</span> AddRoleToUser</h3>
<div class="outline-text-3" id="text-2-19">
<p>
add_role_to_user: session_dict, email, role -&gt; user
</p>
<div class="org-src-container">

<pre class="src src-python" id="add_role_to_user">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">add_role_to_user</span>(session_dict, email_str, role_str):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.get_user_by_email(email_str)
            <span style="font-weight: bold; font-style: italic;">role</span> = SystemInterface.make_role(role_str)
            <span style="font-weight: bold;">return</span> System.do(<span style="font-style: italic;">"add_role_to_user"</span>, 
                             session=session,
                             user=user,
                             role=role)

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-19-1" class="outline-4">
<h4 id="sec-2-19-1"><span class="section-number-4">2.19.1</span> Test Add Role to User</h4>
<div class="outline-text-4" id="text-2-19-1">
<div class="org-src-container">

<pre class="src src-python" id="test_add_role_to_user"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestAddRoleToUser</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_add_role_to_user_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_add_role_to_user_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key
        
        <span style="font-weight: bold; font-style: italic;">user_dict</span> = {<span style="font-style: italic;">'email'</span>: <span style="font-style: italic;">'abc@gnu.org'</span>,
                             <span style="font-style: italic;">'role'</span>: Config.user_role,
                             <span style="font-style: italic;">'name'</span>: <span style="font-style: italic;">"Test User"</span> }

        <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.add_user(session_dict, user_dict)
        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(user.get(<span style="font-style: italic;">"roles"</span>)), 1)
        <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.add_role_to_user(session_dict,
                                                    <span style="font-style: italic;">"abc@gnu.org"</span>,
                                                    Config.admin_role)
        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(user.get(<span style="font-style: italic;">"roles"</span>)), 2)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2-20" class="outline-3">
<h3 id="sec-2-20"><span class="section-number-3">2.20</span> DelRoleOfUser</h3>
<div class="outline-text-3" id="text-2-20">
<p>
del_role_of_user: session_dict, email, role -&gt; user
</p>
<div class="org-src-container">

<pre class="src src-python" id="del_role_of_user">    <span style="font-weight: bold; text-decoration: underline;">@staticmethod</span>
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">del_role_of_user</span>(session_dict, email_str, role_str):
        <span style="font-weight: bold;">try</span>:
            <span style="font-weight: bold; font-style: italic;">session</span> = SystemInterface.make_session(session_dict)
            <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.get_user_by_email(email_str)
            <span style="font-weight: bold; font-style: italic;">role</span> = SystemInterface.make_role(role_str)
            <span style="font-weight: bold;">return</span> System.do(<span style="font-style: italic;">"del_role_of_user"</span>, 
                             session=session,
                             user=user,
                             role=role)

        <span style="font-weight: bold;">except</span> (ArityError, <span style="font-weight: bold; text-decoration: underline;">TypeError</span>, NotAuthorizedError, StateError) <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err

        <span style="font-weight: bold;">except</span> <span style="font-weight: bold; text-decoration: underline;">Exception</span> <span style="font-weight: bold;">as</span> err:
            <span style="font-weight: bold;">raise</span> err
</pre>
</div>
</div>

<div id="outline-container-sec-2-20-1" class="outline-4">
<h4 id="sec-2-20-1"><span class="section-number-4">2.20.1</span> Test Del Role of User</h4>
<div class="outline-text-4" id="text-2-20-1">
<div class="org-src-container">

<pre class="src src-python" id="test_del_role_of_user"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestDelRoleOfUser</span>(TestCase):
    <span style="font-weight: bold; font-style: italic;">TESTING</span> = <span style="font-weight: bold; text-decoration: underline;">True</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">create_app</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold; font-style: italic;">app</span> = create_app(config)
        <span style="font-weight: bold;">return</span> app

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        db.create_all()
        Config.populate_db()
        SystemInterface.initialize(PersistenceDelegate)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">tearDown</span>(<span style="font-weight: bold;">self</span>):
        db.session.remove()
        db.drop_all()
        <span style="font-weight: bold; font-style: italic;">System.delegate</span> = <span style="font-weight: bold; text-decoration: underline;">None</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_del_role_of_user_passes</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">print</span> <span style="font-style: italic;">"test_del_role_of_user_passes"</span>

        <span style="font-weight: bold; font-style: italic;">email</span> = Config.admin_email
        <span style="font-weight: bold; font-style: italic;">key</span> = <span style="font-style: italic;">"abcde"</span>
        <span style="font-weight: bold; font-style: italic;">role_name</span> = SystemInterface.authorize_user(email, key)

        <span style="font-weight: bold; font-style: italic;">session_dict</span> = {}
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'email'</span>] = email
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'role'</span>] = role_name
        <span style="font-weight: bold; font-style: italic;">session_dict</span>[<span style="font-style: italic;">'key'</span>] = key
        
        <span style="font-weight: bold; font-style: italic;">user_dict</span> = {<span style="font-style: italic;">'email'</span>: <span style="font-style: italic;">'abc@gnu.org'</span>,
                             <span style="font-style: italic;">'role'</span>: Config.user_role,
                             <span style="font-style: italic;">'name'</span>: <span style="font-style: italic;">"Test User"</span> }


        <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.add_user(session_dict, user_dict)

        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(user.get(<span style="font-style: italic;">"roles"</span>)), 1)

        <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.add_role_to_user(session_dict,
                                                    <span style="font-style: italic;">"abc@gnu.org"</span>,
                                                    Config.admin_role)
        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(user.get(<span style="font-style: italic;">"roles"</span>)), 2)

        <span style="font-weight: bold; font-style: italic;">user</span> = SystemInterface.del_role_of_user(session_dict,
                                                    <span style="font-style: italic;">"abc@gnu.org"</span>,
                                                    Config.admin_role)
        <span style="font-weight: bold;">self</span>.assertEqual(<span style="font-weight: bold;">len</span>(user.get(<span style="font-style: italic;">"roles"</span>)), 1)
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: <span class="timestamp-wrapper"><span class="timestamp">[2017-01-25 Wed]</span></span></p>
<p class="author">Author: VLEAD</p>
<p class="date">Created: 2017-04-26 Wed 22:27</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.1.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
